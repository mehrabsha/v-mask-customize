!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).VueMask={})}(this,(function(e){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function t(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function o(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(n){r(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}var i="_",a="function",u=[];function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if(!l(e))throw new Error("Text-mask:convertMaskToPlaceholder; The mask property must be an array.");if(-1!==e.indexOf(n))throw new Error("Placeholder character must not be used as part of the mask. Please specify a character that is not present in your mask as your placeholder character.\n\n"+"The placeholder character that was received is: ".concat(JSON.stringify(n),"\n\n")+"The mask that was received is: ".concat(JSON.stringify(e)));return e.map((function(e){return e instanceof RegExp?n:e})).join("")}function l(e){return Array.isArray&&Array.isArray(e)||e instanceof Array}function f(e){for(var n,r=[];-1!==(n=e.indexOf("[]"));)r.push(n),e.splice(n,1);return{maskWithoutCaretTraps:e,indexes:r}}var s=[],p="";function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!l(r)){if(n(r)!==a)throw new Error("Text-mask:conformToMask; The mask property must be an array.");r=f(r=r(e,t)).maskWithoutCaretTraps}var o=t.guide,u=void 0===o||o,v=t.previousConformedValue,d=void 0===v?p:v,h=t.placeholderChar,g=void 0===h?i:h,y=t.placeholder,m=void 0===y?c(r,g):y,b=t.currentCaretPosition,O=t.keepCharPositions,k=!1===u&&void 0!==d,w=e.length,x=d.length,j=m.length,E=r.length,P=w-x,T=P>0,V=b+(T?-P:0),A=V+Math.abs(P);if(!0===O&&!T){for(var M=p,S=V;S<A;S++)m[S]===g&&(M+=g);e=e.slice(0,V)+M+e.slice(V,w)}for(var C=e.split(p).map((function(e,n){return{char:e,isNew:n>=V&&n<A}})),R=w-1;R>=0;R--){var N=C[R].char;if(N!==g){var _=R>=V&&x===E;N===m[_?R-P:R]&&C.splice(R,1)}}var D=p,U=!1;e:for(var z=0;z<j;z++){var B=m[z];if(B===g){if(C.length>0)for(;C.length>0;){var F=C.shift(),H=F.char,I=F.isNew;if(H===g&&!0!==k){D+=g;continue e}if(r[z].test(H)){if(!0===O&&!1!==I&&d!==p&&!1!==u&&T){for(var J=C.length,L=null,W=0;W<J;W++){var $=C[W];if($.char!==g&&!1===$.isNew)break;if($.char===g){L=W;break}}null!==L?(D+=H,C.splice(L,1)):z--}else D+=H;continue e}U=!0}!1===k&&(D+=m.substr(z,j));break}D+=B}if(k&&!1===T){for(var q=null,X=0;X<D.length;X++)m[X]===g&&(q=X);D=null!==q?D.substr(0,q+1):p}return{conformedValue:D,meta:{someCharsRejected:U}}}var d={__nextCharOptional__:!0},h={"#":/\d/i,A:/[a-z]/i,N:/[a-z0-9]/i,"?":d,X:/./},g=function(e){return n=e.toString().replace(/.(\/)[gmiyus]{0,6}$/,(function(e){return e.replace("/","?/")})),r=n.lastIndexOf("/"),new RegExp(n.slice(1,r),n.slice(r+1));var n,r},y=function(e){return e instanceof RegExp?e:function(e){return new RegExp("/[".concat(function(e){return"[\\^$.|?*+()".indexOf(e)>-1?"\\".concat(e):e}(e),"]/"))}(e)};function m(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;return e.map((function(e,r,t){var o=n[e]||e,i=t[r-1],a=n[i]||i;return o===d?null:a===d?g(y(o)):o})).filter(Boolean)}function b(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;return m(e.split(""),n)}var O=function(e){return e instanceof HTMLInputElement?e:e.querySelector("input")||e},k=function(e){return"function"==typeof e},w=function(e){return"string"==typeof e};var x=function(){var e=new Map,n={previousValue:"",mask:[]};function r(r){return e.get(r)||o({},n)}return{partiallyUpdate:function(n,t){e.set(n,o(o({},r(n)),t))},remove:function(n){e.delete(n)},get:r}}();function j(e){!function(e,n){var r=document.createEvent("HTMLEvents");r.initEvent(n,!0,!0),e.dispatchEvent(r)}(e,"input")}function E(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.value,t=x.get(e),o=t.previousValue,i=t.mask,a=r!==o,u=r.length>o.length,c=r&&a&&u;if((n||c)&&i){var l=v(r,i,{guide:!1}),f=l.conformedValue;e.value=f,j(e)}x.partiallyUpdate(e,{previousValue:r})}function P(e,n,r){var t;t=Array.isArray(n)?function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;return m(e.map((function(e){return e instanceof RegExp?e:"string"==typeof e?e.split(""):null})).filter(Boolean).reduce((function(e,n){return e.concat(n)}),[]),n)}(n,r):k(n)?n:w(n)&&n.length>0?b(n,r):n,x.partiallyUpdate(e,{mask:t})}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;return null===e||Array.isArray(e)||"object"!==n(e)?t:Object.keys(e).reduce((function(n,t){var i=e[t];return null===i||i instanceof RegExp?o(o({},n),{},r({},t,i)):n}),t)}function V(e){return(Array.isArray(e)?e:[e]).filter((function(e){return w(e)||e instanceof RegExp})).toString()}function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=T(e&&e.placeholders);return{bind:function(e,r){var t=r.value;console.log("bind"),console.log(e),console.log(t),console.log("---------"),P(e=O(e),t,n),E(e)},componentUpdated:function(e,r){var t=r.value,o=r.oldValue;t=function(e){return e.replace(/[۰-۹]/g,(function(e){return"۰۱۲۳۴۵۶۷۸۹".indexOf(e)}))}(t.replace(/[٠-٩]/g,(function(e){return"۰۱۲۳۴۵۶۷۸۹"["٠١٢٣٤٥٦٧٨٩".indexOf(e)]}))),console.log("componentUpdated"),console.log(e),console.log(t),console.log(o),console.log("---------"),e=O(e);var i=k(t)||V(o)!==V(t);i&&P(e,t,n),E(e,i)},unbind:function(e){e=O(e),x.remove(e)}}}var M=A(),S=function(e,n){var r=b(n);return w(e)||Number.isFinite(e)?v("".concat(e),r,{guide:!1}).conformedValue:e},C=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.directive("mask",A(n)),e.filter("VMask",S)};e.VueMaskDirective=M,e.VueMaskFilter=S,e.VueMaskPlugin=C,e.default=C,Object.defineProperty(e,"__esModule",{value:!0})}));
